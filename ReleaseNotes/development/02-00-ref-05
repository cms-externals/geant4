
                       geant4-02-00-ref-05
                       ===================

Some of the improvements and fixes included since the last reference
tag are:
    - Fixes and additions in geometry/solids and general QA code
      review for geometry module.
    - Corrections on polarized Compton, G4IeBremsstrahlung and
      G4Cerenkov in standard electromagnetic processes.
    - New Store/RetrievePhysicsTable() utility methods
    - New "parameterisations" top-category for concrete
      parameterisation models (PAIcluster, Photocluster, ...).
    - New module "analysis" for analysis/histogramming management
      based on AIDA interfaces.
    - New G4GeneralParticleSource class as primary source
      generator with special options for primary event particle
      and vertex.
    - Introduction of "includes" target for installation of Geant4
      header-files in a single area ($G4INSTALL path).

---------- Reference-tag 'Release Notes' -----------

Summarised, the list of changes is the following:

analysis
--------
- New module for analysis/histogramming management and concrete
  drivers interfaces through AIDA: JAS, Lizard, OpenScientist.

configuration
-------------
- Add -MG option to output dependency files to handle autogenerated
  or not-found headers.
- Removed obsolete script for shared libraries: makeshlib.sh.
- common.gmk, globlib.gmk: added rules for "includes" gmake target. 
- architecture.gmk: introduced new user settable variable G4INCLUDE 
  to specify path where headers (files or symbolic-links) should be
  installed. 

event
-----
- Introduced G4GeneralParticleSource and related classes. 
  G4GeneralParticleSource is an alternative primary source 
  generator to G4ParticleGun. It has all the functions of 
  G4ParticleGun plus many options for specifying the primary 
  event particle and vertex. 

interfaces
----------
- Minor fixes in G4VInteractorManager and G4VUIShell.

g3tog4
------
- Added protection against multiple positiong of the same physical 
  volume and added methods ClearG3PosCopy(G4int) and ClearDivision() 
  in G3VolTableEntry . 
- Removed useless G3toG4Debug global method and file. 
  Replaced verbosity by G3G4DEBUG flag. 
- Removed obsolete class/files G3CalcParams[.hh.cc]. 

geometry
--------
- QA code cleanup from Code-Wizard and warnings issued by 
  "-Wall -ansi -pedantic" g++ compiler options.
- General QA code review.
- solids/Boolean:
  o Added new set methods for matrix/vectors to G4DisplacedSolid:
    SetTransform(G4AffineTransform&),
    SetDirectTransform(G4AffineTransform&),
    SetFrameRotation(const G4RotationMatrix&),
    SetFrameTranslation(const G4ThreeVector&),
    SetObjectRotation(const G4RotationMatrix&),
    SetObjectTranslation(const G4ThreeVector&).
- solids/BREPS
  o Fix in G4Ellipse::Project() for computation of u as function
    of atan2().
  o Changed return value to be "const" pointer to functions:
    - G4BREPSolid::GetPlace()
    - G4BREPSolid::GetBBox()
  o G4Assembly: fix in destructor, added call to clearAndDestroy().
  o G4BREPSolid: changed method NumberOfFaces() to GetNumberOfFaces().
  o G4Curve: fixed obsolete workaround for XlC compiler.
  o G4OsloMatrix: changed internal class "Matrix" to "G4PointMatrix"
    and updated classes making use of it.
  o G4ThreeMat:removed unused overloaded operators =, +, -, +=, -=, *.
- solids/STEP
  o dirobj.h: protected from missing definition of MAXNAMLEN, S_IFMT
    and S_IFDIR originally defined in /usr/include/sys/stat.h.
- solids/STEPinterface
  o Added GetInstanceManager() method to G4GeometryCreator.
  o Changed return value to "const char*" to method Name() and made
    post-const in all creator classes.
  o Fix in G4Axis2Placement3dCreator::CreateSTEPGeometry(void*).
- solids/CSG
  o Bug fixed in G4Tubs::Inside(p) for analysis of phi positioning 
    when on +-fDz surface.
  o Fix in G4Tubs::DistanceToOut(p,v,...): initialised sr and sphi to
    kInfinity and re-introduced additional condition on check for
    Rmin intersection (t2 >= 0).
- magneticfield
  o Fix in G4FieldManager: added check on existence of allocated
    fChordFinder in CreateChordFinder(G4MagneticField*) method.
  o Changed return value to be "const" pointer to functions: 
    + G4EquationOfMotion::GetFieldObj() 
    + G4FieldManager::GetDetectorField() 
    + G4MagIntegratorDriver::GetStepper() 
  o Fixed and corrected signature to G4MagIntegratorDriver::SetHmin(). 
- management
  o Fix in G4VSolid::CalculateClippedPoligonExtent():
    removed assumption that pMin less than pMax by eliminating "else"
    condition.
- volumes
  o Changed return value to be "const" pointer to functions:
    - G4LogicalBorderSurface::GetVolume1()
    - G4LogicalBorderSurface::GetVolume2()
    - G4LogicalSkinSurface::GetLogicalVolume()

global
------
- QA code cleanup from Code-Wizard and warnings issued by 
  "-Wall -ansi -pedantic" g++ compiler options.

parameterisations
-----------------
- New top category for specific parameterisation models:
  G4FoamXrayTRmodel, G4GamDistrXrayTRmodel, G4IrregularXrayTRmodel,
  G4PAIclusterModel, G4PhotoClusterModel, G4PlateIrrGasXrayTRmodel,
  G4RegularXrayTRmodel, G4VClusterModel, G4VXrayTRmodel.

processes/management
--------------------
- Fixed bugs in G4ProcTblElement::operator= 
- Removed destruction of processes in G4ProcessTable destructor.
- Implemented full STL migration in G4ProcessVector.
- Added thePILfactor and GPIL methods in G4VProcess.
- Added Store/RetrievePhysicsTable() methods.

processes/electromagnetic/lowenergy
-----------------------------------
- Bug fix related to the charge dependence of ion fluctuations.
- Bug fix to electron energy loss fluctuations.
- Fixes to G4LowEnergyUtilities to replace the obsolete HepString
  with G4String.
- Removed const casts.
- Bug fixes for problems found on setting cuts.
- Bug fix for nuclear stopping table name, improvements in 
  code quality and added comments for the Software Reference Manual.

processes/electromagnetic/standard
----------------------------------
- Corrections on Polarized Compton:
  o Sampling of Phi
  o Depolarization probability 
- G4IeBremsstrahlung:
  o new cross section/en.loss parametrisation, LPM flag.
  o corrections in the LPM implementation.
- Changed signature in GetLossWithFluct.
- G4SynchrotronRadiation: added "const" qualifier to usage of
  const G4Field*.

processes/electromagnetic/muons
-------------------------------
- Changed signature in GetLossWithFluct.

processes/electromagnetic/utils
-------------------------------
- G4EnergyLossMessenger: created subdirectory /process/eLoss.
  Added class description for Software Reference Manual.
- EnergyLossTable: use "const G4Material*" where required.

processes/electromagnetic/xrays
-------------------------------
- Introduced correction to G4Cerenkov to fix a problem when 
  an optical medium has refraction indices all equal to 1. 

processes/hadronic/models/radiative_decay
-----------------------------------------
- Code correction in integration of Fermi beta functions.

run
---
- Added Retrieve/StorePhysicsTable() and related methods in
  G4VUserPhysicsList and modified BuildPhysicsTable() method. 
- Added store/retreivePhysicsTable command in
  G4UserPhysicsListMessenger.
- Moved default place for storing random number status out of main
  directory.
- Added G4VModularPhysicsList and G4VPhysicsConstructor 
  to modularize UserPhysicsList.
- Fixed bug in G4VUserPhysicsList::StorePhysicsTable().

examples
--------
- New reference outputs and improvements.

tests
-----
- New reference outputs and improvements.
